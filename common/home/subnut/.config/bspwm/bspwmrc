#!/bin/sh

sxhkd &
# pkill -f "DISPLAY=$DISPLAY sxhkd"
# sh -c "DISPLAY=$DISPLAY sxhkd &> /dev/null" &
# disown

xsetroot -cursor_name left_ptr &
xset r rate 300 20

xmodmap -e 'add Lock = XF86Favorites ' && \
xmodmap -e 'remove Lock = Caps_Lock' && \
xmodmap -e 'remove control = Control_L' && \
xmodmap -e 'keysym Caps_Lock = Control_L' && \
xmodmap -e 'add control = Control_L' && \
# pkill -f "DISPLAY=$DISPLAY xcape"
# sh -c "DISPLAY=$DISPLAY xcape -t 300 -e 'Control_L=XF86Favorites'" &
# disown
xcape -t 300 -e 'Control_L=XF86Favorites' &


bspc config border_width        10
bspc config window_gap          20
bspc config split_ratio         0.50
bspc config borderless_monocle  true
bspc config gapless_monocle     false
bspc config single_monocle      true
bspc config initial_polarity    first_child

bspc config normal_border_color  '#808080'
bspc config active_border_color  '#404040'
bspc config focused_border_color '#000000'

bspc config focus_follows_pointer       true
bspc config pointer_follows_focus       true
bspc config pointer_follows_monitor     true
bspc config merge_overlapping_monitors  true
bspc config ignore_ewmh_fullscreen      true

# NOTE: use xprop to get these values
bspc rule -a VirtualBoxVM state=floating
bspc rule -a "VirtualBox Machine" state=tiled
bspc rule -a jome state=floating
bspc rule -a '*:*:Picture-in-Picture' state=floating layer=above sticky=on focus=off
bspc rule -a '*:*:Picture-in-picture' state=floating layer=above sticky=on focus=off
bspc rule -a Safeeyes state=floating layer=above fullscreen=off focus=off
bspc rule -a Clipster layer=above
bspc rule -a mpv state=pseudo_tiled
bspc rule -a GParted state=floating layer=above
bspc rule -a feh state=floating layer=above focus=on
bspc rule -a Zathura state=tiled
bspc rule -a Surf state=tiled


# pkill -f "DISPLAY=$DISPLAY xmousepasteblock"
# sh -c "DISPLAY=$DISPLAY xmousepasteblock &> /dev/null" &
# disown
xmousepasteblock &> /dev/null &

# pkill -f  "DISPLAY=$DISPLAY clipster"
# sh -c "DISPLAY=$DISPLAY clipster -d &> /dev/null" &
# disown
clipster -d &> /dev/null &


# safeeyes -e &> /dev/null &
# sh -c "$(which safeeyes) -e &> /dev/null &"


# if [[ -r /dev/video0 || -r /dev/video1 ]]
# then zsh <<< "kitty sh -c 'echo \"Disabling camera ...\"
# sudo chmod -r /dev/video*' &"; fi &

urxvtc || urxvtd -q -f -o

# pkill -q picom
# picom --experimental-backends &> /dev/null &

# pkill -f "DISPLAY=$DISPLAY xcompmgr"
# sh -c "DISPLAY=$DISPLAY xcompmgr &> /dev/null" &
# disown

picom &

test -x ~/.config/bspwm/desktop_manager || \
	cc ~/.config/bspwm/desktop_manager.c -o ~/.config/bspwm/desktop_manager
exec /bin/sh -c 'bspc subscribe report | ~/.config/bspwm/desktop_manager | /bin/sh'
